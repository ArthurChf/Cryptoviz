import unittest
from src.process.news.etl_news_transform import transform_news_data
from src.tests.process.news_sample import getSamples
from src.config.clickhouse_config import ClickHouseConfig

class NewsTransformTest(unittest.TestCase):

    # def test_dataframe_generation(self):
    #     data = getSamples()
    #     news_df = __generate_dataframe_from_news(data)
    #     self.assertGreater(len(news_df), 0)
    #     pass
    
    # def test_tuple_generation(self):
    #     data = getSamples()
    #     news_tuple = list(transform_news_data(data))
    #     self.assertGreater(len(news_tuple), 0)
    #     pass

    # def test_analyze_sentiment(self):
    #     text = str("Ethereum (ETH) has made significant floki strides in its xrp 2024 roadmap with the successful launch of the Dencun upgrade on the final Holesky testnet.  This is seen as a crucial step towards deploying the upgrade on the mainnet, signaling Ethereum&#8217;s progress in improving transaction efficiency, and scalability and reducing transaction fees by up to 90%. As a result, ETH has surged 2.9% in the last 24 hours, breaking its previous downtrend. Ethereum Dencun Upgrade The Dencun upgrade was first activated on the Sepolia testnet in January 2024, following its deployment on the Goerli testnet. This upgrade aligns with Ethereum&#8217;s broader strategy to enhance scalability and reduce transaction costs for its users.  Related Reading: Cardano Founder Takes Jab At Solana After Major Outage Introducing the concept of &#8220;proto-danksharding,&#8221; Dencun aims to decrease transaction costs for layer-2 blockchains and address scalability challenges, paving the way for the eventual implementation of &#8220;danksharding&#8221; for further benefits. Once fully implemented, Dencun is expected to significantly increase Ethereum&#8217;s transaction processing capacity, potentially enabling the network to handle over 100,000 transactions per second. According to the network’s development team, this scalability enhancement is crucial for supporting the growing ecosystem of decentralized applications (dApps) and users on Ethereum. Furthermore, Dencun will have notable technical improvements, such as the introduction of &#8216;blobs,&#8217; which reduce the cost of rollups on the Ethereum mainnet by compressing transaction data off-chain.  By caching data needed for short-term transaction verification, blobs aim to minimize storage and processing requirements, further enhancing the network&#8217;s transactional capabilities. Anticipation For ETH&#8217;s Market Impact The successful implementation of the Dencun upgrade holds the potential for significant implications on ETH’s market value, driven by a combination of factors. Firstly, the upgrade&#8217;s enhanced network capabilities, including boosted transaction processing capacity and reduced costs, are expected to attract more developers and users to the Ethereum ecosystem.  With improved scalability and lower transaction fees, Ethereum could become a more attractive platform for building dApps and conducting transactions. This increased utility and demand for Ethereum could have a positive impact on its market value as more participants seek to acquire ETH tokens. The perceived reliability and forward momentum resulting from the successful implementation of Dencun may attract more investors to consider Ethereum as an investment opportunity. The increased interest and demand for ETH tokens driven by this positive sentiment can contribute to potential price appreciation. Lastly, the anticipation of Dencun&#8217;s benefits and the reactions to its successful implementation may lead to short-term price volatility, with investors adjusting their positions based on their expectations of how the upgrade will impact Ethereum&#8217;s functionality and market position. Related Reading: Microstrategy Buys More Bitcoin: Here’s How Much Profit It Holds Now All of these developments could have a significant impact on ETH&#8217;s price trajectory and position the token in a long bullish trend, if this momentum continues to be capitalized on, the next barrier at $2,450 could be easily surpassed, potentially sending ETH to new highs.  While the long-term implications remain to be seen, this is a positive development for ETH bulls as the network has lacked significant catalysts and has been involved in a significant price correction for the past 3 weeks. With activations on the Sepolia and Goerli testnets already completed, the final testnet deployment, Holesky, was initially scheduled for February 7, 2024. However, it has now been rescheduled for March 2024.  Featured image from Shutterstock, chart from TradingView.com")
    #     sentiment = __analyze_content_sentiment(text)
    #     assert sentiment >= 0
    #     pass
    
    # def test_extract_crypto(self):
    #     text = str("Ethereum (ETH) has made significant floki strides in its xrp 2024 roadmap with the successful launch of the Dencun upgrade on the final Holesky testnet.  This is seen as a crucial step towards deploying the upgrade on the mainnet, signaling Ethereum&#8217;s progress in improving transaction efficiency, and scalability and reducing transaction fees by up to 90%. As a result, ETH has surged 2.9% in the last 24 hours, breaking its previous downtrend. Ethereum Dencun Upgrade The Dencun upgrade was first activated on the Sepolia testnet in January 2024, following its deployment on the Goerli testnet. This upgrade aligns with Ethereum&#8217;s broader strategy to enhance scalability and reduce transaction costs for its users.  Related Reading: Cardano Founder Takes Jab At Solana After Major Outage Introducing the concept of &#8220;proto-danksharding,&#8221; Dencun aims to decrease transaction costs for layer-2 blockchains and address scalability challenges, paving the way for the eventual implementation of &#8220;danksharding&#8221; for further benefits. Once fully implemented, Dencun is expected to significantly increase Ethereum&#8217;s transaction processing capacity, potentially enabling the network to handle over 100,000 transactions per second. According to the network’s development team, this scalability enhancement is crucial for supporting the growing ecosystem of decentralized applications (dApps) and users on Ethereum. Furthermore, Dencun will have notable technical improvements, such as the introduction of &#8216;blobs,&#8217; which reduce the cost of rollups on the Ethereum mainnet by compressing transaction data off-chain.  By caching data needed for short-term transaction verification, blobs aim to minimize storage and processing requirements, further enhancing the network&#8217;s transactional capabilities. Anticipation For ETH&#8217;s Market Impact The successful implementation of the Dencun upgrade holds the potential for significant implications on ETH’s market value, driven by a combination of factors. Firstly, the upgrade&#8217;s enhanced network capabilities, including boosted transaction processing capacity and reduced costs, are expected to attract more developers and users to the Ethereum ecosystem.  With improved scalability and lower transaction fees, Ethereum could become a more attractive platform for building dApps and conducting transactions. This increased utility and demand for Ethereum could have a positive impact on its market value as more participants seek to acquire ETH tokens. The perceived reliability and forward momentum resulting from the successful implementation of Dencun may attract more investors to consider Ethereum as an investment opportunity. The increased interest and demand for ETH tokens driven by this positive sentiment can contribute to potential price appreciation. Lastly, the anticipation of Dencun&#8217;s benefits and the reactions to its successful implementation may lead to short-term price volatility, with investors adjusting their positions based on their expectations of how the upgrade will impact Ethereum&#8217;s functionality and market position. Related Reading: Microstrategy Buys More Bitcoin: Here’s How Much Profit It Holds Now All of these developments could have a significant impact on ETH&#8217;s price trajectory and position the token in a long bullish trend, if this momentum continues to be capitalized on, the next barrier at $2,450 could be easily surpassed, potentially sending ETH to new highs.  While the long-term implications remain to be seen, this is a positive development for ETH bulls as the network has lacked significant catalysts and has been involved in a significant price correction for the past 3 weeks. With activations on the Sepolia and Goerli testnets already completed, the final testnet deployment, Holesky, was initially scheduled for February 7, 2024. However, it has now been rescheduled for March 2024.  Featured image from Shutterstock, chart from TradingView.com")
    #     cryptocurrencies = __extract_cryptocurrency_symbols(text)
    #     assert len(cryptocurrencies) > 0
    #     pass
    
    def test_transform_news_data(self):
        data = getSamples()
        news_tuple = list(transform_news_data(data))
        self.assertGreater(len(news_tuple), 0)
        pass
    
    def test_insert_data(self):
        data = getSamples()
        news_tuple = list(transform_news_data(data))
        client = ClickHouseConfig('localhost', 8123, 'default', 'default')
        client.insert_many(news_tuple)
        pass

